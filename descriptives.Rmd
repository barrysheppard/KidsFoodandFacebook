---
title: "Adolescents, Facebook, and Food"
author: "Barry Sheppard"
date: "18 June 2016"
output: html_document
---


```{r load, echo=FALSE, message=FALSE}
# Loading up some data

library("psych")
library("tidyr")
library(ggplot2)
library(ggthemes)
library(plyr)
library(scales)

# Load the data
source("load.R", print.eval=TRUE)


# Descriptives

#
# Some basic demographic information
#
```

#Total participants
```{r, echo=FALSE}
nrow(data)
```


```{r, echo=FALSE}
# 1 = 13, 2 = 14
data$age <- factor(data$age, levels = c(1,2,3), labels = c("13","14", "other"))
ggplot(data=data, aes(x=age, fill=age)) +
  geom_bar(colour = "black", stat="count") +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Age") +
  guides(fill=FALSE)
```



```{r, echo=FALSE}
# 1 = Male, 2 = Female
data$gender <- factor(data$gender, levels = c(1,2), labels = c("Male","Female"))
ggplot(data=data, aes(x=gender, fill=gender)) +
  geom_bar(colour = "black", stat="count") +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Gender") +
  guides(fill=FALSE)

```


```{r, echo=FALSE}
# Please tell me how often you go online or use the internet, from a computer, a mobile phone, a smartphone, or any other device you may use to go online (please tick one):
data$how.often <- factor(data$how.often, levels = c(1,2,3,4), labels = c("Several times a day", "Daily or almost daily","At least weekly", "Never or almost never"))
ggplot(data=data, aes(x=how.often, fill=how.often)) +
  geom_bar(colour = "black", stat="count") +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Please tell me how often you go online or use the internet,\n from a computer, a mobile phone, a smartphone, or any other\n device you may use to go online (please tick one):") +
  guides(fill=FALSE)
```


```{r, echo=FALSE, warning=FALSE}
# How many hours of television do you watch every day?

ggplot(data, aes(x=tv.use)) +
  geom_histogram(colour = "black", binwidth=.5) +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("How many hours of television do you watch every day?") +
  geom_vline(aes(xintercept=mean(tv.use, na.rm=T)), color="red", linetype="dashed", size=1)
describe(data$tv.use)
```


```{r, echo=FALSE}
# Roughly how many people are you in contact with on social media (Please tick one):
data$contacts <- factor(data$contacts, levels = c(1,2,3,4,5), labels = c("Up to 10",	"11-50",	"51-100",	"101-300",	"More than 300"))
ggplot(data=data, aes(x=contacts, fill=contacts)) +
  geom_bar(colour = "black", stat="count") +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Roughly how many people are you in contact with on\n social media (Please tick one):") +
  guides(fill=FALSE)
```


```{r, echo=FALSE}
# is your profile set to (Please tick one):
data$profile.privacy <- factor(data$profile.privacy, levels = c(1,2,3,4), labels = c("Public, so that everyone\n can see", "Partially private, so that\n friends of friends on your\n network can see", "Private, so that only\n your friends can see", "don't know"))
ggplot(data=data, aes(x=profile.privacy, fill=profile.privacy)) +
  geom_bar(colour = "black", stat="count") +
  guides(fill=FALSE) +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), hjust=2, colour = "white") +
  ggtitle("is your profile set to (Please tick one):") +
  theme(plot.title = element_text(hjust = -1)) +
  coord_flip() 
```


```{r, echo=FALSE}
# There are lots of things on the internet that are good for children of my age (Please tick one):
data$good.things <- factor(data$good.things, levels = c(1,2,3), labels = c("Not True", "A bit True", "Very True"))
ggplot(data=data, aes(x=good.things, fill=good.things)) +
  geom_bar(colour = "black", stat="count") +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("There are lots of things on the internet that are good for\n children of my age") +
  guides(fill=FALSE)
```


```{r, echo=FALSE}
# Graphing the 'Which of these things do you know how do to?' data

# Create the data frame
task <- factor(x = c(1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10), levels = c(1,2,3,4,5,6,7,8,9,10), labels = c("Block unwanted adverts or junk mail spam", "Delete the record of which sites they have visited", "Change privacy settings on social networking profile", "Block messages from someone they don't want to\n hear from", "Find information on how to use the internet safely", "Publish a comment on a blog, website or forum", "Upload images, videos or music onto social meda", "Create a blog", "Update status on social networking site used most", "Take a picture or a short video with smartphone\n and upload it on to social media"))
result <- factor(x = c(1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0), levels = c(1,0), labels = c("Yes", "No"))
total <- c(sum(data$blocking_1 == 1, na.rm=NA), sum(data$blocking_2 == 1, na.rm=NA), sum(data$blocking_3 == 1, na.rm=NA), sum(data$blocking_4 == 1, na.rm=NA), sum(data$blocking_5 == 1, na.rm=NA), sum(data$posting_1 == 1, na.rm=NA), sum(data$posting_2 == 1, na.rm=NA), sum(data$posting_3 == 1, na.rm=NA), sum(data$updating_1 == 1, na.rm=NA), sum(data$updating_2 == 1, na.rm=NA))
total <- c(total, sum(is.na(data$blocking_1)), sum(is.na(data$blocking_2)), sum(is.na(data$blocking_3)), sum(is.na(data$blocking_4)), sum(is.na(data$blocking_5)), sum(is.na(data$posting_1)), sum(is.na(data$posting_2)), sum(is.na(data$posting_3)), sum(is.na(data$updating_1)), sum(is.na(data$updating_2)) )
percentage <- round(total/nrow(data)*100)
pos = (percentage - 0.5 * percentage)
chart_df <- data.frame(task, result, total, percentage, pos)

ggplot(chart_df, aes(x = task, y = percentage, fill = result)) + 
  geom_bar(colour = "black", stat="identity", width= .9) +
  xlab("\nTask") +
  ylab("%\n") +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(aes(label = ifelse(result == "Yes", paste0(percentage,"%"), ""), y = pos), position = "stack", color='white') +
  coord_flip() + 
  theme(legend.position = "bottom") +
  theme(text = element_text(size=9)) +
  theme(legend.title = element_blank()) +
  ggtitle("Which of these things do you know how to do?") +
  theme(plot.title = element_text(hjust = 2)) 
```


#What do you like most about Facebook?
```{r, echo=FALSE}
# What do you like most about Facebook?
data$most.liked
```
#What do you like least about Facebook?
```{r, echo=FALSE}
# What do you like least about Facebook?
data$least.liked
```


```{r, echo=FALSE}
# Do you know how Facebook, Instagram or Youtube decide which adverts appear in your news feed?
data$how.adverts.appear <- factor(data$how.adverts.appear, levels = c(1,2), labels = c("Yes", "No"))
ggplot(data=data, aes(x=how.adverts.appear, fill=how.adverts.appear)) +
  geom_bar(colour="black", stat="count") +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Do you know how Facebook, Instagram or Youtube decide\n which adverts appear?") +
  guides(fill=FALSE)
```

#If yes, please explain how Facebook decides which adverts appear in your news feed.
```{r, echo=FALSE}
# If yes, please explain how Facebook decides which adverts appear in your news feed.
data$explain.if.yes
```

#Thinking about the time you spend on the internet overall, what do you spend most time doing?  
```{r, echo=FALSE}
# Thinking about the time you spend on the internet overall, what do you spend most time doing?  
data$most.time.spent
```




# Which internet platforms do you use the most? 
Please number them in order of how much time you send on them. 1 = most often, 2 - second most often, etc. 
You can leave ones you don't use as 0


```{r, echo=FALSE}
# Facebook

ggplot(data=data, aes(x=platforms_1, fill=platforms_1)) +
  geom_bar(colour = "black", stat="count") +
  guides(fill=FALSE)+
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Facebook") +
  xlab("") 

```


```{r, echo=FALSE}
# Snapchat

ggplot(data=data, aes(x=platforms_2, fill=platforms_2)) +
  geom_bar(colour = "black", stat="count") +
  guides(fill=FALSE)+
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Snapchat") +
  xlab("") 

```



```{r, echo=FALSE}

ggplot(data=data, aes(x=platforms_3, fill=platforms_3)) +
  geom_bar(colour = "black", stat="count") +
  guides(fill=FALSE)+
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Youtube") +
  xlab("") 


```



```{r, echo=FALSE}
# WhatsApp

ggplot(data=data, aes(x=platforms_4, fill=platforms_4)) +
  geom_bar(colour = "black", stat="count") +
  guides(fill=FALSE) +
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("WhatsApp") +
  xlab("") 


```



```{r, echo=FALSE}
# Instagram

ggplot(data=data, aes(x=platforms_5, fill=platforms_5)) +
  geom_bar(colour = "black", stat="count") +
  guides(fill=FALSE)+
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Instagram") +
  xlab("") 

```


```{r, echo=FALSE}
# Other
ggplot(data=data, aes(x=platforms_6, fill=platforms_6)) +
  geom_bar(colour = "black", stat="count") +
  guides(fill=FALSE)+
  theme_economist() + 
  scale_fill_economist() +
  geom_text(stat='count', aes(label=..count..), vjust=2, colour = "white") +
  ggtitle("Other") +
  xlab("") 

data$platforms_6_TEXT

```

